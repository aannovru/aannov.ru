<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru-ru" lang="ru-ru"> 
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>Calculating Age in Rails</title>
   <meta name="author" content="Анонимные Алкоголики Нижний Новгород" />
   <meta name="description"
         content="Алкоголизм - выход есть! Анонимные Алкоголики Нижний Новгород. Адреса групп, контактные телефоны, новости и статьи." />
   <meta name="keywords" content="алкоголизм, нижний новгород, анонимные алкоголики, адреса групп аа, адреса собраний аа, aa, аа, 12 шагов, сообщество аа, содружество аа" /> 
   <link href="http://feeds.feedburner.com/aannovru" rel="alternate" 
         title="Анонимные Алкоголики Нижний Новгород" type="application/atom+xml" />
   <link rel="shortcut icon" href="/favicon.ico" />

   <!-- syntax highlighting CSS -->
   <link rel="stylesheet" href="/css/syntax.css" type="text/css" />

   <!-- Homepage CSS -->
   <link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection" />
</head>
<body>

<div class="site">
  <h1 class="header"><a href="/">Анонимные Алкоголики Нижний Новгород</a></h1>
  <div id="aa_motto_parent_div">      
    <div id="aa_motto_img_div">  
      <a href="/"><img id="aa_motto_img" src="/images/aa-logo-en.gif"
          alt="Выздоровление Единство Служение" />
      </a>    
    </div>    

    <div id="aa_motto_child_div" >
      <p>
        <a id="aa_motto_link_no_underline" class="aa_motto_link_no_underline" href="/solution">    
          Выздоровление Единство Служение
        </a>
        ♦ 
        <a id="aa_motto_link_no_underline" class="aa_motto_link_no_underline" href="/solution">    
          12 Шагов
        </a>
        <br />
        8 960 197 92 48 <br />
        <a href="mailto:aannovru@gmail.com">aannovru@gmail.com</a>        
      </p>
    </div>
  </div>

  <div class="title" id="aa_menu_div">
    <a class="extra" href="/">Главная</a>
    <a class="extra" href="/solution">12 Шагов</a>
    <a class="extra" href="/community">Как нас найти</a>
    <a class="extra" href="/stories">Наши истории</a>
    <a class="extra" href="/links">Ссылки</a>
  </div>

  
    
   



<div id="post">
  
    <p>
  
    <a href="/solution">→&nbsp;12 Шагов</a>
  
</p>
<!-- vim: set sts=2 sw=2 et: --> 


    
      <p>
      <span class="post_tags">Метки:&nbsp;</span>
        
          <a class="post_tags_underline" href="/solution/index.html#метка2">
            <u>метка2</u>
          </a>
          &nbsp;&nbsp;
        
      </p>
    
  

    
  <h1>Calculating Age in Rails</h1>
  <p class="meta">
    
      13.10.2008
    
    <a href="/solution/2008/10/13/calculating-age-in-rails.html">(ссылка)</a>   
  </p>

  <p>You&#8217;d think that this would be easy, but for some reason it wasn&#8217;t, at least for me. Let&#8217;s say you keep track of a User&#8217;s birthday with a date field. Great! Let&#8217;s show the user&#8217;s age.</p>
<p>Liquid error: No such file or directory &#8211; pygmentize -l ruby -f html -O encoding=utf-8</p>
<p>Done! Right? <span class="caps">WRONG</span>. Worked fine for some users, until one of my coworkers asked me&#8230;hey, you&#8217;re not 21 yet&#8230;how&#8217;d you magically gain a year on your profile? Crap. Obviously this will work for everyone&#8217;s whose birthday is <span class="caps">BEFORE</span> <code>Date.today</code>, but not after.</p>
<p>So, we need a more exact method of calculating the age:<br />
Liquid error: No such file or directory &#8211; pygmentize -l ruby -f html -O encoding=utf-8</p>
<p>So what this method does instead is use the <code>Rational</code> value given by subtracting two <code>Date</code>s, and divides it by the number of days in a year. Since that number is still a <code>Rational</code>, calling <code>floor</code> on it will round it down to the nearest <code>Fixnum</code>, giving us a (slightly more) precise account of this user&#8217;s age. <strong><span class="caps">EDIT</span>: But this is still inaccurate!</strong></p>
<p>Yeah, I thought it was easy too. Perhaps this shows that I need to test my app a little more thoroughly! It also would be nice to save the age in an instance level variable, but right now I don&#8217;t use the age more than once on a page so it doesn&#8217;t matter.</p>
<p><strong><span class="caps">EDIT</span></strong>: It looks like my method is still not sufficient for leap years! The comments have posted <span class="caps">MANY</span> great solutions. My method is fine for a general estimation, but the comments have many solutions for that deal with greater accuracy. I&#8217;m honestly not sure which is best, so choose carefully when you&#8217;re developing your app.</p>
</div>

<!-- vim: set sts=2 sw=2 et: --> 

  
  <div class="footer">
    <div class="contact">
      <p>
        Анонимные Алкоголики Нижний Новгород<br />
        8 960 197 92 48<br />
        <a href="mailto:aannovru@gmail.com">aannovru@gmail.com</a>        
      </p>
    </div>

    <div class="rss">
      <a href="http://feeds.feedburner.com/aannovru">
        <img src="/images/rss.png" alt="Subscribe to RSS Feed" />
      </a>
    </div>
  </div>
</div>

</body>
</html>
<!-- vim: set sts=2 sw=2 et: --> 
